#!/bin/bash

# Install Dependencies: sudo apt install diceware pwgen xsel

echo "UNIQUE PASSWORD GENERATOR"

INPUT="\033[1;33m"    # Yellow for input
OUTPUT="\033[0;36m"   # Cyan for output
RESET="\033[0m"       # Reset color
WIPE="\033[1A\033[0G" # Move cursor up & erase line

GET_PROMPT() {
    local PROMPT="$1"
    local DEFAULT="$2"
	declare -n RESULT="$3" 

    echo -ne "${PROMPT}${INPUT}"
    IFS= read -r VALUE

    RESULT=${VALUE:-"$DEFAULT"}
    echo -ne "${RESET}${WIPE}${PROMPT}${OUTPUT}${RESULT}${RESET}\n"
 
    eval "$3=\"$RESULT\""
}

GET_PROMPT "Domain or device name: " "default.com" DOMAIN
GET_PROMPT "Login username: " "username" USER
GET_PROMPT "Pass phrase (blank to gen): " ${SALT:=$(diceware -n 8 -d "_" -s 4)} SALT
GET_PROMPT "Password length: " "128" LENGTH

TEXT="Complexity: " 
echo "Choose your password character complexity: "
PS3=$(echo -ne "${TEXT}${INPUT}")
options=("Simple" "Special")
select opt in "${options[@]}"
do
    case $opt in
        "Simple")
			COMPLEXITY="Simple"
			break
			;;
        "Special")
			COMPLEXITY="Special"
			break
			;;
        *) echo -e "Invalid option $REPLY";;
    esac
done
echo -ne "${RESET}${WIPE}${TEXT}${OUTPUT}${COMPLEXITY}${RESET}\n"

SEED="$DOMAIN+$USER+$SALT"

if [ "$COMPLEXITY" == "Simple" ];
    then PASS=$(pwgen $LENGTH 1 -H <((echo $SEED)) -cn);
    else PASS=$(pwgen $LENGTH 1 -H <((echo $SEED)) -cnsy);
fi

echo "▼▼▼ UNIQUE PASSWORD GENERATED ▼▼▼"
echo -n "$PASS" | xsel --clipboard --input
echo -e "$OUTPUT[Copied to clipboard]$RESET"